# Kickstart file automatically generated by anaconda.

text
install
cdrom
firstboot --disable
lang en_US.UTF-8
keyboard us
network --onboot yes --device eth0 --bootproto dhcp --noipv6 --hostname=centos7
rootpw  linux
firewall --disabled
authconfig --enableshadow --passalgo=sha512
selinux --disabled
skipx
timezone  Asia/Shanghai
reboot
bootloader --location=mbr --driveorder=sda --append="crashkernel=auto level=10 console=tty0 console=ttyS0,115200"

zerombr
clearpart --all --initlabel
part swap --fstype="swap" --size=2048
part / --asprimary --fstype="ext4" --grow --size=1

%packages --nobase
@core
%end

%post
rm -f /etc/yum.repos.d/Cent*


cat > /etc/yum.repos.d/centos.repo << EOF
[CentOS7]
name=Aliyun CentOS-7.9.2009
baseurl=https://mirrors.aliyun.com/centos/7.9.2009/os/$basearch/
gpgcheck=0
gpgkey=https://mirrors.aliyun.com/RPM-GPG-KEY-CentOS-7

[CentOS7-update]
name=Aliyun CentOS-7.9.2009-update
baseurl=https://mirrors.aliyun.com/centos/7.9.2009/updates/$basearch/
gpgcheck=0
gpgkey=https://mirrors.aliyun.com/RPM-GPG-KEY-CentOS-7

[CentOS7-extras]
name=Aliyun CentOS-7.9.2009-extras
baseurl=https://mirrors.aliyun.com/centos/7.9.2009/extras/$basearch/
gpgcheck=0
gpgkey=https://mirrors.aliyun.com/RPM-GPG-KEY-CentOS-7

EOF

sed -i 's/crashkernel=auto/crashkernel=auto console=tty0 level=10/g' /boot/grub2/grub.cfg
sed -i 's/crashkernel=auto/crashkernel=auto console=tty0 level=10/g' /etc/default/grub

systemctl enable serial-getty@ttyS0.service
chmod +x /etc/rc.d/rc.local
systemctl enable rc-local.service

%end

