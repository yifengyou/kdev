#cloud-config
autoinstall:
  version: 1
  updates: security
  console: |
    type=serial
    rich-mode=true
  refresh-installer:
    update: false
  apt:
    disable_components: []
    geoip: true
    preserve_sources_list: false
    primary:
    - arches:
      - amd64
      uri: https://mirrors.aliyun.com/ubuntu
  drivers:
    install: false
  identity:
    hostname: ubuntu
    password: $6$q10NM4gzbYU2IeND$j39lZZXhl0UA8jcrxwbBupYoAtrKdyH2DNU1/rbkbJ9jH95kYghEHW5J.SFH55zWPMJB/GP1.7TQixxqXKbl.0
    realname: ubuntu
    username: ubuntu
  user-data:
    disable_root: false
    chpasswd:
      list: |
        root:linux
      expire: false
  kernel:
    package: linux-generic
    cmdline: cloud-init=disabled
  keyboard:
    layout: us
    toggle: null
    variant: ''
  hostname: ubuntu2204
  locale: en_US.UTF-8
  timezone: Asia/Shanghai
  network:
    ethernets:
      enp1s0:
        dhcp4: true
    version: 2
  ssh:
    allow-pw: true
    authorized-keys: []
    install-server: true
  packages:
    - vim
  storage:
    layout:
      name: direct
  grub:
    install_devices:
      - /dev/sda
  late-commands:
    - sed -i -e 's/^#\?PasswordAuthentication.*/PasswordAuthentication yes/g' /target/etc/ssh/sshd_config
    - touch /target/etc/cloud/cloud-init.disabled
